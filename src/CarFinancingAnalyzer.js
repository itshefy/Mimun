import React, { useState, useEffect, useRef } from 'react';
import DatePicker from 'react-datepicker';
import { registerLocale } from 'react-datepicker';
import he from 'date-fns/locale/he';
import "react-datepicker/dist/react-datepicker.css";
import './CarFinancingAnalyzer.css';

registerLocale('he', he);

const CarFinancingConversationAnalyzer = () => {
  // קבועים ונתונים
  const occupations = [
    'מהנדס תוכנה', 'מפתח Full Stack', 'מנהל מוצר', 'מעצב UX/UI', 'מנתח נתונים',
    'מנהל פרויקטים IT', 'ארכיטקט מערכות', 'מומחה אבטחת מידע', 'מפתח אפליקציות',
    'מהנדס DevOps', 'מנהל רשתות', 'מפתח בינה מלאכותית', 'מפתח Blockchain',
    'נציג שירות לקוחות', 'מנהל שירות לקוחות', 'יועץ מכירות', 'מנהל קשרי לקוחות',
    'נציג תמיכה טכנית', 'מנהל חשבונות לקוח', 'מומחה חווית לקוח',
    'רופא', 'אחות', 'רוקח', 'פיזיותרפיסט', 'פסיכולוג', 'רופא שיניים', 'דיאטן',
    'מרפא בעיסוק', 'וטרינר', 'מנתח', 'רדיולוג', 'אופטומטריסט',
    'עורך דין', 'שופט', 'פרקליט', 'נוטריון', 'יועץ משפטי', 'מתמחה במשפטים',
    'מורה', 'מרצה באוניברסיטה', 'גננת', 'מנהל בית ספר', 'יועץ חינוכי',
    'מאמן כושר', 'פיזיולוג ספורט', 'מדריך יוגה', 'תזונאי ספורט', 'שחקן מקצועי',
    'שף', 'קונדיטור', 'סו שף', 'מנהל מסעדה', 'סומלייה', 'ברמן',
    'מהנדס חשמל', 'מהנדס מכונות', 'מהנדס אזרחי', 'מהנדס כימיה', 'מהנדס תעשייה וניהול',
    'אדריכל', 'מעצב פנים', 'מתכנן ערים', 'מעצב נוף', 'מהנדס בניין',
    'עיתונאי', 'צלם', 'עורך וידאו', 'מפיק', 'כתב', 'קריין',
    'טייס', 'דייל', 'מהנדס תעופה', 'בקר טיסה', 'מכונאי מטוסים',
    'מנהל בנק', 'יועץ השקעות', 'אנליסט פיננסי', 'חתם ביטוח', 'סוכן נדל"ן',
    'מדען', 'חוקר', 'ביולוג', 'כימאי', 'פיזיקאי', 'מתמטיקאי',
    'אמן', 'מוזיקאי', 'שחקן', 'רקדן', 'סופר', 'צייר',
    'מנכ"ל', 'סמנכ"ל', 'מנהל משאבי אנוש', 'מנהל שיווק', 'מנהל כספים',
    'יזם', 'משקיע', 'מייסד סטארטאפ', 'אנג\'ל משקיע', 'מנטור עסקי'
  ];

  const carTypes = ['מיני', 'משפחתי', 'ג\'יפ', 'טנדר', 'רכב שטח', 'ספורט'];
  const fuelTypes = ['בנזין', 'היברידי', 'חשמלי', 'דיזל'];

  const personalityTraits = {
    'מהנדס תוכנה': ['אנליטי', 'יצירתי', 'פותר בעיות', 'לוגי', 'מדויק'],
    'מפתח Full Stack': ['רב-תחומי', 'גמיש', 'לומד מהר', 'טכנולוגי', 'יצירתי'],
    'מנהל מוצר': ['אסטרטגי', 'תקשורתי', 'מנהיג', 'חדשני', 'אנליטי'],
    'מעצב UX/UI': ['יצירתי', 'אמפתי', 'פרפקציוניסט', 'חדשני', 'תקשורתי'],
    'מנתח נתונים': ['אנליטי', 'סקרן', 'מדייק', 'ביקורתי', 'מתקשר'],
    'מנהל פרויקטים IT': ['מאורגן', 'מנהיג', 'פותר בעיות', 'תקשורתי', 'גמיש'],
    'ארכיטקט מערכות': ['חשיבה מערכתית', 'חדשני', 'אסטרטגי', 'פותר בעיות', 'תקשורתי'],
    'מומחה אבטחת מידע': ['קפדן', 'אנליטי', 'עירני', 'אתי', 'מעודכן'],
    'מפתח אפליקציות': ['יצירתי', 'ממוקד משתמש', 'טכנולוגי', 'פותר בעיות', 'חדשני'],
    'מהנדס DevOps': ['אוטומציה', 'יעילות', 'פותר בעיות', 'תקשורתי', 'גמיש'],
    'מנהל רשתות': ['טכני', 'פותר בעיות', 'מאורגן', 'אחראי', 'תקשורתי'],
    'מפתח בינה מלאכותית': ['חדשני', 'אנליטי', 'סקרן', 'מתמטי', 'יצירתי'],
    'מפתח Blockchain': ['חדשני', 'אבטחתי', 'אנליטי', 'פותר בעיות', 'מעודכן'],
    'נציג שירות לקוחות': ['סבלני', 'אמפתי', 'תקשורתי', 'פותר בעיות', 'חיובי'],
    'מנהל שירות לקוחות': ['מנהיג', 'אמפתי', 'אסטרטגי', 'תקשורתי', 'פותר בעיות'],
    'יועץ מכירות': ['משכנע', 'תקשורתי', 'יוזם', 'אמפתי', 'מוטיבציוני'],
    'מנהל קשרי לקוחות': ['דיפלומטי', 'תקשורתי', 'אסטרטגי', 'אמפתי', 'מנהל יחסים'],
    'נציג תמיכה טכנית': ['סבלני', 'טכני', 'פותר בעיות', 'תקשורתי', 'רגוע'],
    'מנהל חשבונות לקוח': ['מדויק', 'מאורגן', 'תקשורתי', 'אחראי', 'אנליטי'],
    'מומחה חווית לקוח': ['אמפתי', 'חדשני', 'אנליטי', 'תקשורתי', 'יצירתי'],
    'רופא': ['אמפתי', 'מקצועי', 'רגוע', 'מדויק', 'תקשורתי'],
    'אחות': ['אמפתי', 'סבלני', 'מסור', 'תקשורתי', 'רב-משימתי'],
    'רוקח': ['מדויק', 'ידען', 'תקשורתי', 'אחראי', 'שירותי'],
    'פיזיותרפיסט': ['סבלני', 'מוטיבציוני', 'אמפתי', 'מקצועי', 'תקשורתי'],
    'פסיכולוג': ['אמפתי', 'מקשיב', 'אנליטי', 'סבלני', 'אובייקטיבי'],
    'רופא שיניים': ['מדויק', 'סבלני', 'תקשורתי', 'מרגיע', 'מקצועי'],
    'דיאטן': ['מוטיבציוני', 'ידען', 'אמפתי', 'תקשורתי', 'סבלני'],
    'מרפא בעיסוק': ['יצירתי', 'סבלני', 'אמפתי', 'מקצועי', 'מוטיבציוני'],
    'וטרינר': ['אוהב חיות', 'סבלני', 'מקצועי', 'רגוע', 'תקשורתי'],
    'מנתח': ['מדויק', 'רגוע תחת לחץ', 'מקצועי', 'תקשורתי', 'אחראי'],
    'רדיולוג': ['אנליטי', 'מדויק', 'טכנולוגי', 'תקשורתי', 'מקצועי'],
    'אופטומטריסט': ['מדויק', 'סבלני', 'תקשורתי', 'טכני', 'שירותי'],
    'עורך דין': ['אנליטי', 'תקשורתי', 'אתי', 'פותר בעיות', 'משכנע'],
    'שופט': ['אובייקטיבי', 'אנליטי', 'אתי', 'סבלני', 'החלטי'],
    'פרקליט': ['משכנע', 'אנליטי', 'תקשורתי', 'אסטרטגי', 'תחרותי'],
    'נוטריון': ['מדויק', 'אמין', 'אתי', 'תקשורתי', 'מקצועי'],
    'יועץ משפטי': ['אנליטי', 'אסטרטגי', 'תקשורתי', 'אתי', 'דיסקרטי'],
    'מתמחה במשפטים': ['שאפתן', 'חרוץ', 'לומד מהר', 'אנליטי', 'תקשורתי'],
    'מורה': ['סבלני', 'מעורר השראה', 'תקשורתי', 'יצירתי', 'אמפתי'],
    'מרצה באוניברסיטה': ['אנליטי', 'תקשורתי', 'ידען', 'מחקרי', 'מעורר השראה'],
    'גננת': ['סבלני', 'יצירתי', 'אמפתי', 'אנרגטי', 'מטפח'],
    'מנהל בית ספר': ['מנהיג', 'אסטרטגי', 'תקשורתי', 'פותר בעיות', 'מעורר השראה'],
    'יועץ חינוכי': ['אמפתי', 'מקשיב', 'תומך', 'אנליטי', 'תקשורתי'],
    'מאמן כושר': ['מוטיבציוני', 'אנרגטי', 'סבלני', 'תקשורתי', 'מקצועי'],
    'פיזיולוג ספורט': ['אנליטי', 'מקצועי', 'תקשורתי', 'מחקרי', 'מוטיבציוני'],
    'מדריך יוגה': ['רגוע', 'סבלני', 'מעורר השראה', 'תקשורתי', 'אמפתי'],
    'תזונאי ספורט': ['ידען', 'מוטיבציוני', 'אנליטי', 'תקשורתי', 'יצירתי'],
    'שחקן מקצועי': ['תחרותי', 'משמעת עצמית', 'מוטיבציוני', 'עבודת צוות', 'פיזי'],
    'שף': ['יצירתי', 'מדויק', 'עמיד בלחץ', 'מנהיג', 'חושי'],
    'קונדיטור': ['יצירתי', 'מדויק', 'סבלני', 'פרפקציוניסט', 'אסתטי'],
    'סו שף': ['מנהיג', 'יעיל', 'יצירתי', 'עמיד בלחץ', 'עבודת צוות'],
    'מנהל מסעדה': ['מנהיג', 'פותר בעיות', 'תקשורתי', 'יעיל', 'שירותי'],
    'סומלייה': ['חושי', 'ידען', 'תקשורתי', 'שירותי', 'סבלני'],
    'ברמן': ['חברותי', 'יעיל', 'יצירתי', 'רב-משימתי', 'עמיד בלחץ'],
    'מהנדס חשמל': ['אנליטי', 'טכני', 'פותר בעיות', 'יצירתי', 'מדויק'],
    'מהנדס מכונות': ['אנליטי', 'טכני', 'יצירתי', 'פותר בעיות', 'מדויק'],
    'מהנדס אזרחי': ['אנליטי', 'מדויק', 'פרקטי', 'אחראי', 'יצירתי'],
    'מהנדס כימיה': ['אנליטי', 'מדויק', 'סקרן', 'מחקרי', 'בטיחותי'],
    'מהנדס תעשייה וניהול': ['אנליטי', 'יעיל', 'מנהיג', 'פותר בעיות', 'אסטרטגי'],
    'אדריכל': ['יצירתי', 'חזוני', 'טכני', 'אסתטי', 'פרקטי'],
    'מעצב פנים': ['יצירתי', 'אסתטי', 'תקשורתי', 'פרקטי', 'קשוב ללקוח'],
    'מתכנן ערים': ['אסטרטגי', 'חזוני', 'אנליטי', 'סביבתי', 'תקשורתי'],
    'מעצב נוף': ['יצירתי', 'סביבתי', 'טכני', 'אסתטי', 'פרקטי'],
    'מהנדס בניין': ['טכני', 'מדויק', 'אחראי', 'פותר בעיות', 'בטיחותי'],
    'עיתונאי': ['סקרן', 'תקשורתי', 'אנליטי', 'אובייקטיבי', 'יצירתי'],
    'צלם': ['יצירתי', 'טכני', 'סבלני', 'קשוב לפרטים', 'אסתטי'],
    'עורך וידאו': ['יצירתי', 'טכני', 'סבלני', 'קשוב לפרטים', 'חזוני'],
    'מפיק': ['מנהיג', 'יצירתי', 'פותר בעיות', 'תקשורתי', 'אסטרטגי'],
    'כתב': ['סקרן', 'תקשורתי', 'אנליטי', 'יצירתי', 'עמיד בלחץ'],
    'קריין': ['קולי', 'תקשורתי', 'מקצועי', 'רגוע', 'מדויק'],
    'טייס': ['רגוע תחת לחץ', 'מדויק', 'אחראי', 'טכני', 'החלטי'],
    'דייל': ['שירותי', 'סבלני', 'תקשורתי', 'רב-תרבותי', 'רגוע תחת לחץ'],
    'מהנדס תעופה': ['אנליטי', 'טכני', 'חדשני', 'מדויק', 'בטיחותי'],
    'בקר טיסה': ['רגוע תחת לחץ', 'מדויק', 'תקשורתי', 'אחראי', 'ריכוז גבוה'],
    'מכונאי מטוסים': ['טכני', 'מדויק', 'אחראי', 'פותר בעיות', 'בטיחותי'],
    'מנהל בנק': ['אחראי', 'אנליטי', 'תקשורתי', 'אתי', 'מנהיג'],
    'יועץ השקעות': ['אנליטי', 'תקשורתי', 'אתי', 'עדכני', 'אסטרטגי'],
    'אנליסט פיננסי': ['אנליטי', 'מדויק', 'עדכני', 'אסטרטגי', 'תקשורתי'],
    'חתם ביטוח': ['אנליטי', 'מדויק', 'אתי', 'תקשורתי', 'פותר בעיות'],
    'סוכן נדל"ן': ['תקשורתי', 'משכנע', 'יוזם', 'סבלני', 'אסטרטגי'],
    'מדען': ['סקרן', 'אנליטי', 'מדויק', 'מחקרי', 'ביקורתי'],
    'חוקר': ['סקרן', 'אנליטי', 'מתודי', 'סבלני', 'ביקורתי'],
    'ביולוג': ['סקרן', 'מדויק', 'אנליטי', 'סביבתי', 'מחקרי'],
    'כימאי': ['אנליטי', 'מדויק', 'סקרן', 'בטיחותי', 'מחקרי'],
    'פיזיקאי': ['אנליטי', 'מתמטי', 'סקרן', 'תיאורטי', 'מחקרי'],
    'מתמטיקאי': ['אנליטי', 'לוגי', 'מדויק', 'מופשט', 'פותר בעיות'],
    'אמן': ['יצירתי', 'רגיש', 'אקספרסיבי', 'חזוני', 'אינדיבידואליסט'],
    'מוזיקאי': ['יצירתי', 'רגיש', 'מוזיקלי', 'מקצועי', 'תקשורתי'],
    'שחקן': ['אקספרסיבי', 'רגיש', 'גמיש', 'תקשורתי', 'יצירתי'],
    'רקדן': ['אתלטי', 'אקספרסיבי', 'יצירתי', 'משמעת עצמית', 'פיזי'],
    'סופר': ['יצירתי', 'אנליטי', 'סבלני', 'מתבודד', 'רגיש'],
    'צייר': ['יצירתי', 'חזוני', 'סבלני', 'קשוב לפרטים', 'אסתטי'],
    'מנכ"ל': ['מנהיג', 'אסטרטגי', 'החלטי', 'תקשורתי', 'חזוני'],
    'סמנכ"ל': ['מנהיג', 'אסטרטגי', 'תקשורתי', 'יעיל', 'תומך'],
    'מנהל משאבי אנוש': ['אמפתי', 'תקשורתי', 'אסטרטגי', 'פותר בעיות', 'דיפלומטי'],
    'מנהל שיווק': ['יצירתי', 'אסטרטגי', 'תקשורתי', 'אנליטי', 'חדשני'],
    'מנהל כספים': ['אנליטי', 'מדויק', 'אסטרטגי', 'אתי', 'החלטי'],
    'יזם': ['חדשני', 'נוטל סיכונים', 'אסטרטגי', 'גמיש', 'עמיד בלחץ'],
    'משקיע': ['אנליטי', 'אסטרטגי', 'נוטל סיכונים', 'סבלני', 'החלטי'],
    'מייסד סטארטאפ': ['חדשני', 'יזמי', 'עמיד בלחץ', 'גמיש', 'חזוני'],
    'אנג\'ל משקיע': ['אסטרטגי', 'מנטור', 'נוטל סיכונים', 'חזוני', 'מנוסה'],
    'מנטור עסקי': ['מנוסה', 'תקשורתי', 'אסטרטגי', 'אמפתי', 'מעורר השראה']
  };

  const carDatabase = {
    'מיני': {
      'חדש': [
        { name: 'מיני קופר', price: 150000, features: ['עיצוב אייקוני', 'חווית נהיגה ספורטיבית', 'איכות פרימיום', 'אפשרויות התאמה אישית', 'מותג יוקרתי'], description: 'מיני קופר היא התגלמות הסטייל והספורטיביות בקטגוריית המיני. עם עיצוב אייקוני וחווית נהיגה ספורטיבית, היא מציעה איכות פרימיום ואפשרויות רבות להתאמה אישית. המותג היוקרתי מוסיף לערך הכולל של הרכב.' },
        { name: 'פיאט 500', price: 120000, features: ['עיצוב רטרו מקסים', 'חסכוני בדלק', 'קל לתמרון בעיר', 'אפשרויות התאמה אישית', 'מחיר אטרקטיבי'], description: 'פיאט 500 מביאה את הקסם האיטלקי לקטגוריית המיני. העיצוב הרטרו המקסים שלה משתלב היטב עם יעילות בצריכת הדלק וקלות תמרון בסביבה עירונית. האפשרויות להתאמה אישית והמחיר האטרקטיבי הופכים אותה לבחירה פופולרית.' },
        { name: 'רנו טוינגו', price: 110000, features: ['תמרון קל במיוחד', 'חסכוני בדלק', 'עיצוב צעיר ומודרני', 'מרווח פנימי מפתיע', 'מחיר תחרותי'], description: 'רנו טוינגו היא מכונית מיני עם יכולות תמרון יוצאות דופן. היא חסכונית בדלק ומציעה עיצוב צעיר ומודרני. המרווח הפנימי המפתיע והמחיר התחרותי הופכים אותה לאפשרות אטרקטיבית למי שמחפש רכב עירוני קומפקטי.' },
        { name: 'פולקסווגן אפ!', price: 115000, features: ['איכות גרמנית', 'חסכוני בדלק', 'קל לחניה', 'טכנולוגיה מתקדמת', 'מרווח פנימי טוב'], description: 'פולקסווגן אפ! מביאה את האיכות הגרמנית לקטגוריית המיני. היא חסכונית בדלק וקלה לחניה, מה שהופך אותה לאידיאלית לשימוש עירוני. הטכנולוגיה המתקדמת והמרווח הפנימי הטוב מוסיפים ערך לחבילה הכוללת.' },
        { name: 'סמארט פורטו', price: 130000, features: ['קומפקטי במיוחד', 'קל לחניה', 'חסכוני בדלק', 'עיצוב ייחודי', 'טכנולוגיה חכמה'], description: 'סמארט פורטו היא המכונית האולטימטיבית לסביבה עירונית צפופה. היא קומפקטית במיוחד וקלה לחניה, מה שהופך אותה לפתרון מושלם לבעיות חניה. החיסכון בדלק, העיצוב הייחודי והטכנולוגיה החכמה מוסיפים לאטרקטיביות שלה.' }
      ],
      'משומש': [
        { name: 'טויוטה איגו', price: 50000, features: ['אמינות יפנית', 'חסכוני בדלק', 'עלויות תחזוקה נמוכות', 'קל לתמרון', 'מחיר נוח'], description: 'טויוטה איגו היא בחירה מצוינת כרכב מיני משומש. היא מציעה את האמינות היפנית המפורסמת לצד חיסכון בדלק ועלויות תחזוקה נמוכות. הקלות בתמרון והמחיר הנוח הופכים אותה לאפשרות אטרקטיבית למי שמחפש רכב עירוני יעיל.' },
        { name: 'פיג\'ו 108', price: 55000, features: ['עיצוב צרפתי מודרני', 'חסכוני בדלק', 'נוח לנהיגה עירונית', 'טכנולוגיה טובה', 'מחיר משתלם'], description: 'פיג\'ו 108 מביאה את הסטייל הצרפתי לקטגוריית המיני. היא חסכונית בדלק ונוחה לנהיגה עירונית. הטכנולוגיה הטובה והמחיר המשתלם הופכים אותה לבחירה מעניינת בשוק הרכבים המשומשים.' },
        { name: 'סיטרואן C1', price: 52000, features: ['עיצוב צעיר וייחודי', 'חסכוני בדלק', 'קל לתמרון', 'עלויות אחזקה נמוכות', 'מרווח פנימי טוב'], description: 'סיטרואן C1 מציעה עיצוב צעיר וייחודי בקטגוריית המיני. היא חסכונית בדלק וקלה לתמרון, מה שהופך אותה לאידיאלית לשימוש עירוני. העלויות הנמוכות לאחזקה והמרווח הפנימי הטוב מוסיפים לאטרקטיביות שלה כרכב משומש.' },
        { name: 'קיה פיקנטו', price: 58000, features: ['אמינות קוריאנית', 'חסכוני בדלק', 'עיצוב מודרני', 'אבזור טוב', 'ערך תמורה למחיר'], description: 'קיה פיקנטו היא דוגמה מצוינת לאיכות ואמינות קוריאנית בקטגוריית המיני. היא חסכונית בדלק ומציעה עיצוב מודרני ואבזור טוב. הערך הגבוה תמורת המחיר הופך אותה לבחירה חכמה בשוק הרכבים המשומשים.' },
        { name: 'סוזוקי סוויפט', price: 60000, features: ['אמינות יפנית', 'חסכוני בדלק', 'הנדסה טובה', 'נוח לנהיגה', 'פופולרי ועם ביקוש'], description: 'סוזוקי סוויפט היא מכונית מיני פופולרית עם מוניטין של אמינות. היא חסכונית בדלק ומציעה הנדסה טובה ונוחות בנהיגה. הפופולריות והביקוש הגבוה שלה בשוק המשומשות מבטיחים ערך טוב לאורך זמן.' }
      ]
    },
    'משפחתי': {
      'חדש': [
        { name: 'סקודה אוקטביה', price: 180000, features: ['מרווחת', 'חסכונית', 'אמינה', 'בטיחותית', 'תא מטען גדול'], description: 'הסקודה אוקטביה היא בחירה מצוינת למשפחות. היא מציעה שילוב מושלם של מרחב, נוחות וחסכוניות. עם תא מטען ענק ומערכות בטיחות מתקדמות, היא מתאימה לכל צורכי המשפחה.' },
        { name: 'יונדאי i35', price: 170000, features: ['עיצוב מודרני', 'טכנולוגיה מתקדמת', 'נוחות נסיעה', 'חסכונית בדלק', 'אחריות ארוכה'], description: 'יונדאי i35 מביאה עיצוב עדכני וטכנולוגיה חדישה לקטגוריית הרכבים המשפחתיים. היא מצטיינת בנוחות נסיעה ובחסכוניות בדלק, ומגיעה עם אחריות יצרן ארוכה במיוחד.' },
        { name: 'קיה סיד', price: 165000, features: ['איכות בנייה גבוהה', 'מערכות בטיחות מתקדמות', 'נוחות נהיגה', 'עיצוב אירופאי', 'תמורה טובה למחיר'], description: 'הקיה סיד מציעה איכות אירופאית במחיר תחרותי. היא בולטת באיכות הבנייה הגבוהה שלה, במערכות הבטיחות המתקדמות ובנוחות הנהיגה. עיצובה האירופאי מוסיף יוקרה לחבילה כולה.' },
        { name: 'טויוטה קורולה', price: 175000, features: ['אמינות גבוהה', 'ערך שוק גבוה', 'חסכונית בדלק', 'נוחות נסיעה', 'טכנולוגיה יפנית מתקדמת'], description: 'הטויוטה קורולה היא סמל לאמינות וערך שוק גבוה. היא מציעה נסיעה נוחה, חסכונית בדלק ומצוידת בטכנולוגיה יפנית מתקדמת. זוהי בחירה בטוחה למשפחות המחפשות רכב אמין לטווח ארוך.' },
        { name: 'מאזדה 3', price: 178000, features: ['עיצוב ספורטיבי', 'חווית נהיגה מהנה', 'איכות גימור גבוהה', 'מערכות בטיחות מתקדמות', 'צריכת דלק נמוכה'], description: 'מאזדה 3 מביאה רוח ספורטיבית לקטגוריית הרכבים המשפחתיים. היא מציעה חווית נהיגה מהנה, איכות גימור גבוהה ומערכות בטיחות מתקדמות. העיצוב הספורטיבי שלה מושך תשומת לב, בעוד צריכת הדלק הנמוכה חוסכת בהוצאות.' }
      ],
      'משומש': [
        { name: 'פורד פוקוס', price: 80000, features: ['אמינות', 'נוחות נהיגה', 'חלקי חילוף זולים', 'מרווחת', 'חסכונית בדלק'], description: 'הפורד פוקוס היא בחירה מצוינת כרכב משפחתי משומש. היא ידועה באמינותה, נוחות הנהיגה שלה והמרווח הפנימי. חלקי החילוף הזולים והחסכוניות בדלק הופכים אותה לכלכלית לאחזקה.' },
        { name: 'הונדה סיוויק', price: 85000, features: ['אמינות גבוהה', 'ביצועים טובים', 'איכות בנייה', 'ערך שוק גבוה', 'חסכונית'], description: 'הונדה סיוויק היא מכונית אמינה עם ביצועים מרשימים. איכות הבנייה הגבוהה שלה מבטיחה עמידות לאורך זמן, וערך השוק הגבוה שלה הופך אותה להשקעה טובה. בנוסף, היא חסכונית בדלק, מה שמוריד את עלויות התפעול.' },
        { name: 'פיג\'ו 308', price: 75000, features: ['נוחות צרפתית', 'עיצוב אלגנטי', 'תא מטען גדול', 'צריכת דלק נמוכה', 'מערכות בטיחות'], description: 'פיג\'ו 308 מביאה את הנוחות והאלגנטיות הצרפתית לקטגוריית הרכבים המשפחתיים. היא מצטיינת בעיצוב מרשים, תא מטען גדול במיוחד וצריכת דלק נמוכה. מערכות הבטיחות המתקדמות מוסיפות שקט נפשי לנסיעות המשפחתיות.' },
        { name: 'סיאט לאון', price: 82000, features: ['מנועים חזקים', 'עיצוב ספורטיבי', 'טכנולוגיה גרמנית', 'חסכונית', 'נוחה לנהיגה'], description: 'סיאט לאון מציעה את היתרונות של טכנולוגיה גרמנית במחיר תחרותי. היא מצטיינת במנועים חזקים ועיצוב ספורטיבי, תוך שמירה על חסכוניות בדלק. הנוחות בנהיגה הופכת אותה לבחירה מצוינת לנסיעות ארוכות.' },
        { name: 'אופל אסטרה', price: 78000, features: ['אמינות גרמנית', 'נוחות נסיעה', 'מרווחת', 'חסכונית בדלק', 'קלה לתחזוקה'], description: 'האופל אסטרה מביאה את האיכות הגרמנית לקטגוריית המחיר הבינוני. היא ידועה באמינותה, נוחות הנסיעה והמרווח הפנימי. החסכוניות בדלק והתחזוקה הקלה הופכות אותה לבחירה חכמה לטווח הארוך.' }
      ]
    },
    'ג\'יפ': {
      'חדש': [
        { name: 'ג\'יפ צ\'רוקי', price: 250000, features: ['יכולות שטח מעולות', 'נוחות נסיעה', 'טכנולוגיה מתקדמת', 'עיצוב אמריקאי קלאסי', 'מערכות בטיחות מתקדמות'], description: 'ג\'יפ צ\'רוקי מציע את השילוב המושלם בין יכולות שטח מעולות לנוחות נסיעה יומיומית. הוא מצויד בטכנולוגיה מתקדמת ומערכות בטיחות חדישות, תוך שמירה על העיצוב האמריקאי הקלאסי שמזוהה עם המותג.' },
        { name: 'קיה ספורטאז\'', price: 180000, features: ['עיצוב מודרני', 'חסכוני בדלק', 'מרווח פנימי גדול', 'טכנולוגיה מתקדמת', 'אחריות ארוכה'], description: 'קיה ספורטאז\' מביא עיצוב מודרני וטכנולוגיה מתקדמת לקטגוריית הג\'יפים הקומפקטיים. הוא מצטיין בחסכוניות בדלק ומציע מרווח פנימי גדול. האחריות הארוכה של קיה מוסיפה שקט נפשי לבעלים.' },
        { name: 'טויוטה RAV4', price: 200000, features: ['אמינות יפנית', 'מערכת היברידית', 'מרווח פנימי גדול', 'ביצועים טובים', 'ערך שוק גבוה'], description: 'טויוטה RAV4 היא סמל לאמינות ויעילות. היא מציעה מערכת הנעה היברידית מתקדמת, מרווח פנימי גדול וביצועים טובים. הערך הגבוה בשוק המשומשות הופך אותה להשקעה חכמה לטווח ארוך.' },
        { name: 'מאזדה CX-5', price: 190000, features: ['עיצוב ספורטיבי', 'חווית נהיגה מהנה', 'איכות פנים גבוהה', 'טכנולוגיית SKYACTIV', 'בטיחות מתקדמת'], description: 'מאזדה CX-5 מביאה רוח ספורטיבית לעולם הג\'יפים. היא מציעה חווית נהיגה מהנה, איכות פנים גבוהה וטכנולוגיית SKYACTIV לשיפור הביצועים והחיסכון בדלק. מערכות הבטיחות המתקדמות מוסיפות שקט נפשי.' },
        { name: 'ניסאן קשקאי', price: 185000, features: ['עיצוב אירופאי', 'נוחות נסיעה', 'טכנולוגיה מתקדמת', 'חסכוני בדלק', 'מערכות בטיחות מתקדמות'], description: 'ניסאן קשקאי הוא ג\'יפ קומפקטי עם עיצוב אירופאי מודרני. הוא מציע נוחות נסיעה גבוהה, טכנולוגיה מתקדמת וחסכוניות בדלק. מערכות הבטיחות המתקדמות הופכות אותו לבחירה מצוינת למשפחות.' }
      ],
      'משומש': [
        { name: 'הונדה CR-V', price: 120000, features: ['אמינות יפנית', 'מרווח פנימי גדול', 'נוחות נסיעה', 'ערך שוק גבוה', 'חסכוני יחסית'], description: 'הונדה CR-V היא בחירה מצוינת כג\'יפ משומש. היא ידועה באמינות הגבוהה שלה, מציעה מרווח פנימי גדול ונוחות נסיעה מעולה. הערך הגבוה בשוק המשומשות והחסכוניות היחסית הופכים אותה לכדאית במיוחד.' },
        { name: 'סובארו פורסטר', price: 125000, features: ['הנעה כפולה', 'יכולות שטח טובות', 'אמינות גבוהה', 'מרווח גחון גבוה', 'בטיחות מצוינת'], description: 'סובארו פורסטר מציע הנעה כפולה קבועה ויכולות שטח מרשימות. הוא ידוע באמינות הגבוהה שלו ובמרווח הגחון הגבוה. מערכות הבטיחות המצוינות מוסיפות שקט נפשי, במיוחד בנסיעות משפחתיות.' },
        { name: 'מיצובישי אאוטלנדר', price: 115000, features: ['7 מושבים', 'חסכוני בדלק', 'אמינות יפנית', 'מערכת הנעה חכמה', 'תא מטען גדול'], description: 'מיצובישי אאוטלנדר הוא ג\'יפ משפחתי עם 7 מושבים, המציע גמישות רבה. הוא חסכוני בדלק ומציע את האמינות היפנית הידועה. מערכת ההנעה החכמה ותא המטען הגדול הופכים אותו לאידיאלי למשפחות גדולות.' },
        { name: 'פורד קוגה', price: 130000, features: ['טכנולוגיה מתקדמת', 'נוחות נסיעה', 'מנועים חזקים', 'עיצוב מודרני', 'מערכות בטיחות טובות'], description: 'פורד קוגה מציע שילוב של טכנולוגיה מתקדמת ונוחות נסיעה גבוהה. הוא מצטיין במנועים חזקים ועיצוב מודרני. מערכות הבטיחות הטובות והביצועים המרשימים הופכים אותו לבחירה מצוינת כג\'יפ משפחתי משומש.' },
        { name: 'פולקסווגן טיגואן', price: 135000, features: ['איכות גרמנית', 'מרווח פנימי גדול', 'טכנולוגיה מתקדמת', 'ביצועים טובים', 'ערך שוק גבוה'], description: 'פולקסווגן טיגואן מביא את האיכות הגרמנית לקטגוריית הג\'יפים הקומפקטיים. הוא מציע מרווח פנימי גדול, טכנולוגיה מתקדמת וביצועים טובים. הערך הגבוה בשוק המשומשות הופך אותו להשקעה טובה לטווח ארוך.' }
      ]
    },
    'טנדר': {
      'חדש': [
        { name: 'טויוטה היילקס', price: 220000, features: ['אמינות גבוהה', 'יכולות שטח מעולות', 'כושר גרירה גבוה', 'ערך שוק יציב', 'מוניטין מצוין'], description: 'טויוטה היילקס הוא סמל לאמינות ועמידות בקטגוריית הטנדרים. הוא מציע יכולות שטח מעולות וכושר גרירה גבוה. הערך היציב בשוק והמוניטין המצוין הופכים אותו לבחירה מובילה עבור עסקים וחובבי שטח.' },
        { name: 'פורד ריינג\'ר', price: 210000, features: ['ביצועים חזקים', 'טכנולוגיה מתקדמת', 'נוחות נסיעה', 'יכולות שטח טובות', 'עיצוב מודרני'], description: 'פורד ריינג\'ר משלב ביצועים חזקים עם טכנולוגיה מתקדמת. הוא מציע נוחות נסיעה גבוהה לצד יכולות שטח מרשימות. העיצוב המודרני שלו מושך תשומת לב, בעוד המנועים החזקים מספקים ביצועים מעולים בכל תנאי שטח.' },
        { name: 'איסוזו D-MAX', price: 200000, features: ['עמידות גבוהה', 'צריכת דלק נמוכה', 'יכולות העמסה טובות', 'תא נוסעים מרווח', 'טכנולוגיית דיזל מתקדמת'], description: 'איסוזו D-MAX ידוע בעמידות הגבוהה שלו ובצריכת הדלק הנמוכה. הוא מציע יכולות העמסה מצוינות ותא נוסעים מרווח. טכנולוגיית הדיזל המתקדמת מבטיחה ביצועים טובים לצד חיסכון בדלק.' },
        { name: 'מיצובישי L200', price: 205000, features: ['שילוב של נוחות ויכולות', 'מערכת הנעה חכמה', 'עיצוב אגרסיבי', 'בטיחות מתקדמת', 'צריכת דלק סבירה'], description: 'מיצובישי L200 מציע שילוב מנצח של נוחות ויכולות שטח. הוא מצויד במערכת הנעה חכמה ומציג עיצוב אגרסיבי. מערכות הבטיחות המתקדמות וצריכת הדלק הסבירה הופכות אותו לאטרקטיבי הן לשימוש יומיומי והן לעבודה.' },
        { name: 'ניסאן נבארה', price: 215000, features: ['יכולות שטח מרשימות', 'נוחות נסיעה טובה', 'טכנולוגיה מתקדמת', 'כושר גרירה גבוה', 'עיצוב חדשני'], description: 'ניסאן נבארה מציע יכולות שטח מרשימות לצד נוחות נסיעה טובה בכביש. הוא מצויד בטכנולוגיה מתקדמת וכושר גרירה גבוה. העיצוב החדשני שלו מבדל אותו מהמתחרים ומושך תשומת לב חיובית.' }
      ],
      'משומש': [
        { name: 'טויוטה היילקס', price: 150000, features: ['אמינות אגדית', 'עמידות גבוהה', 'ערך שוק יציב', 'יכולות שטח מעולות', 'עלויות תחזוקה נמוכות'], description: 'טויוטה היילקס משומש הוא השקעה מצוינת. האמינות האגדית והעמידות הגבוהה שלו מבטיחות שנים רבות של שימוש ללא בעיות. הערך היציב בשוק והעלויות הנמוכות לתחזוקה הופכים אותו לכדאי במיוחד.' },
        { name: 'פורד ריינג\'ר', price: 145000, features: ['ביצועים טובים', 'נוחות נסיעה', 'טכנולוגיה טובה', 'יכולות שטח', 'תא נוסעים מרווח'], description: 'פורד ריינג\'ר משומש מציע ביצועים טובים ונוחות נסיעה גבוהה. הטכנולוגיה הטובה ויכולות השטח שלו נשמרות היטב גם בדגמים ישנים יותר. תא הנוסעים המרווח הופך אותו לאידיאלי גם לשימוש משפחתי.' },
        { name: 'מיצובישי L200', price: 140000, features: ['אמינות יפנית', 'יכולות שטח טובות', 'צריכת דלק סבירה', 'עיצוב מודרני', 'עלויות תחזוקה נמוכות'], description: 'מיצובישי L200 משומש מציע את האמינות היפנית הידועה לצד יכולות שטח טובות. הוא שומר על צריכת דלק סבירה ועיצוב מודרני גם בדגמים ישנים יותר. העלויות הנמוכות לתחזוקה הופכות אותו לאטרקטיבי במיוחד.' },
        { name: 'איסוזו D-MAX', price: 135000, features: ['עמידות גבוהה', 'מנוע דיזל חזק', 'יכולות העמסה טובות', 'פשטות מכנית', 'צריכת דלק נמוכה'], description: 'איסוזו D-MAX משומש ידוע בעמידות הגבוהה שלו ובמנוע הדיזל החזק. הוא מציע יכולות העמסה טובות ופשטות מכנית שמקלה על התחזוקה. צריכת הדלק הנמוכה הופכת אותו לחסכוני לאורך זמן.' },
        { name: 'ניסאן נבארה', price: 142000, features: ['אמינות טובה', 'יכולות שטח', 'נוחות נסיעה', 'ערך שוק טוב', 'טכנולוגיה טובה יחסית'], description: 'ניסאן נבארה משומש מציע אמינות טובה ויכולות שטח מרשימות. הוא שומר על נוחות נסיעה טובה גם בדגמים ישנים יותר. הערך הטוב בשוק והטכנולוגיה הטובה יחסית הופכים אותו לבחירה חכמה בקטגוריית הטנדרים המשומשים.' }
      ]
    },
    'רכב שטח': {
      'חדש': [
        { name: 'טויוטה לנד קרוזר', price: 450000, features: ['אמינות גבוהה', 'יכולות שטח מרשימות', 'נוחות פרימיום', 'טכנולוגיה מתקדמת', 'ערך שוק גבוה'], description: 'טויוטה לנד קרוזר היא מלכת רכבי השטח. היא משלבת אמינות גבוהה עם יכולות שטח מרשימות ונוחות פרימיום. הטכנולוגיה המתקדמת וערך השוק הגבוה הופכים אותה להשקעה מצוינת.' },
        { name: 'ג\'יפ גרנד צ\'ירוקי', price: 380000, features: ['מותג אייקוני', 'יכולות שטח מעולות', 'נוחות גבוהה', 'טכנולוגיה חדשנית', 'עיצוב אמריקאי'], description: 'ג\'יפ גרנד צ\'ירוקי היא נציגה מכובדת של מותג אייקוני בעולם רכבי השטח. היא מציעה יכולות שטח מעולות לצד נוחות גבוהה לנסיעות יומיומיות. הטכנולוגיה החדשנית והעיצוב האמריקאי מוסיפים לאטרקטיביות שלה.' },
        { name: 'לנד רובר דיפנדר', price: 420000, features: ['יכולות שטח יוצאות דופן', 'עיצוב אייקוני מחודש', 'טכנולוגיה מתקדמת', 'נוחות גבוהה', 'מותג יוקרתי'], description: 'לנד רובר דיפנדר החדש משלב מורשת אייקונית עם טכנולוגיה מודרנית. הוא מציע יכולות שטח יוצאות דופן לצד נוחות גבוהה ועיצוב מחודש. המותג היוקרתי והטכנולוגיה המתקדמת הופכים אותו לבחירה מובילה בקטגוריית רכבי השטח.' },
        { name: 'פורד F-150 רפטור', price: 400000, features: ['ביצועי שטח מרשימים', 'עוצמה גבוהה', 'טכנולוגיה מתקדמת', 'יכולת העמסה', 'עיצוב אגרסיבי'], description: 'פורד F-150 רפטור היא גרסת השטח האולטימטיבית של הטנדר הפופולרי ביותר בארה"ב. היא מציעה ביצועי שטח מרשימים, עוצמה גבוהה וטכנולוגיה מתקדמת. יכולת ההעמסה והעיצוב האגרסיבי הופכים אותה לבחירה מצוינת למי שמחפש רכב שטח עם יכולות מעשיות.' },
        { name: 'מרצדס G-Class', price: 550000, features: ['יוקרה ללא פשרות', 'יכולות שטח מרשימות', 'עיצוב אייקוני', 'ביצועים גבוהים', 'טכנולוגיה מתקדמת'], description: 'מרצדס G-Class היא הגדרה מחדש של יוקרה בשטח. היא משלבת יכולות שטח מרשימות עם רמת יוקרה ללא פשרות. העיצוב האייקוני, הביצועים הגבוהים והטכנולוגיה המתקדמת הופכים אותה לבחירה אולטימטיבית בקטגוריית רכבי השטח היוקרתיים.' }
      ],
      'משומש': [
        { name: 'טויוטה FJ קרוזר', price: 150000, features: ['עיצוב רטרו ייחודי', 'יכולות שטח מעולות', 'אמינות גבוהה', 'קהילת חובבים גדולה', 'ערך שוק יציב'], description: 'טויוטה FJ קרוזר היא רכב שטח עם אופי ייחודי. העיצוב הרטרו המיוחד שלה משלב יכולות שטח מעולות עם אמינות גבוהה. קהילת החובבים הגדולה וערך השוק היציב הופכים אותה לבחירה מצוינת בשוק הרכבים המשומשים.' },
        { name: 'ניסאן פטרול', price: 140000, features: ['עמידות גבוהה', 'יכולות שטח מוכחות', 'מנוע חזק', 'מרווח פנימי גדול', 'פשטות מכנית'], description: 'ניסאן פטרול ידוע בעמידות הגבוהה שלו וביכולות השטח המוכחות. עם מנוע חזק ומרווח פנימי גדול, הוא מתאים למשפחות ולחובבי שטח כאחד. הפשטות המכנית שלו הופכת אותו לקל יחסית לתחזוקה ותיקון.' },
        { name: 'מיצובישי פאג\'רו', price: 130000, features: ['אמינות יפנית', 'יכולות שטח טובות', 'נוחות נסיעה', 'מערכת הנעה מתקדמת', 'ערך תמורה למחיר'], description: 'מיצובישי פאג\'רו מציע את האמינות היפנית לצד יכולות שטח טובות. הוא ידוע בנוחות הנסיעה שלו ובמערכת ההנעה המתקדמת. הערך הגבוה תמורת המחיר הופך אותו לאפשרות אטרקטיבית בשוק הרכבים המשומשים.' },
        { name: 'סוזוקי ג\'ימני', price: 90000, features: ['קומפקטי וזריז', 'יכולות שטח מפתיעות', 'חסכוני בדלק', 'קל לתמרון', 'פופולריות גוברת'], description: 'סוזוקי ג\'ימני הוא רכב שטח קומפקטי עם יכולות מפתיעות. הוא זריז, קל לתמרון וחסכוני בדלק. הפופולריות הגוברת שלו בשנים האחרונות מבטיחה ערך שוק טוב ואפשרויות רבות בשוק המשומשות.' },
        { name: 'ג\'יפ רנגלר', price: 160000, features: ['יכולות שטח מובילות', 'עיצוב אייקוני', 'אפשרויות התאמה אישית', 'קהילת חובבים גדולה', 'ערך שוק גבוה'], description: 'ג\'יפ רנגלר הוא אייקון בעולם רכבי השטח. הוא ידוע ביכולות השטח המובילות שלו ובעיצוב האייקוני. האפשרויות הרבות להתאמה אישית וקהילת החובבים הגדולה הופכים אותו לבחירה פופולרית. ערך השוק הגבוה שלו מבטיח השקעה טובה לטווח ארוך.' }
      ]
    },
    'ספורט': {
      'חדש': [
        { name: 'פורשה 911', price: 800000, features: ['ביצועים יוצאי דופן', 'עיצוב איקוני', 'טכנולוגיה מתקדמת', 'חווית נהיגה ייחודית', 'ערך גבוה לאורך זמן'], description: 'פורשה 911 היא אייקון בעולם מכוניות הספורט. היא משלבת ביצועים יוצאי דופן עם עיצוב קלאסי ומודרני. הטכנולוגיה המתקדמת וחווית הנהיגה הייחודית הופכים אותה לבחירה מושלמת לחובבי מכוניות ספורט.' },
        { name: 'שברולט קורבט', price: 550000, features: ['כוח אמריקאי', 'עיצוב מרהיב', 'ביצועים גבוהים', 'טכנולוגיה חדשנית', 'מחיר תחרותי'], description: 'שברולט קורבט מביאה את הכוח האמריקאי לעולם מכוניות הספורט. עם עיצוב מרהיב וביצועים גבוהים, היא מציעה חוויה ספורטיבית אמיתית במחיר תחרותי. הטכנולוגיה החדשנית מוסיפה נדבך נוסף לחוויית הנהיגה.' },
        { name: 'אאודי R8', price: 900000, features: ['מנוע V10 עוצמתי', 'עיצוב פורץ דרך', 'טכנולוגיית quattro', 'איכות גרמנית', 'ביצועים מרשימים'], description: 'אאודי R8 היא מכונית ספורט שמשלבת עוצמה וטכנולוגיה. עם מנוע V10 עוצמתי ומערכת ההנעה quattro, היא מציעה ביצועים מרשימים בכל תנאי דרך. העיצוב הפורץ דרך והאיכות הגרמנית הופכים אותה לבחירה יוקרתית ומרשימה.' },
        { name: 'טויוטה סופרה', price: 450000, features: ['מסורת ספורטיבית', 'שיתוף פעולה עם BMW', 'ביצועים גבוהים', 'עיצוב דינמי', 'מחיר אטרקטיבי'], description: 'טויוטה סופרה מחייה מחדש מסורת ספורטיבית מפוארת. בשיתוף פעולה עם BMW, היא מציעה ביצועים גבוהים ועיצוב דינמי. המחיר האטרקטיבי הופך אותה לאפשרות מפתה בקטגוריית מכוניות הספורט.' },
        { name: 'מרצדס-AMG GT', price: 750000, features: ['עיצוב מרהיב', 'ביצועים יוצאי דופן', 'טכנולוגיה מתקדמת', 'נוחות יוקרתית', 'מותג יוקרה'], description: 'מרצדס-AMG GT היא שילוב מושלם של יוקרה וספורטיביות. עם עיצוב מרהיב וביצועים יוצאי דופן, היא מציעה חוויית נהיגה ייחודית. הטכנולוגיה המתקדמת והנוחות היוקרתית מוסיפות לחוויה הכוללת של בעלות על מכונית ספורט יוקרתית.' }
      ],
      'משומש': [
        { name: 'ניסאן GT-R', price: 300000, features: ['ביצועים מדהימים', 'טכנולוגיה יפנית מתקדמת', 'עיצוב ייחודי', 'אמינות גבוהה', 'ערך שוק יציב'], description: 'ניסאן GT-R, הידועה גם כ"גודזילה", היא מכונית ספורט אגדית. היא משלבת ביצועים מדהימים עם טכנולוגיה יפנית מתקדמת. העיצוב הייחודי והאמינות הגבוהה הופכים אותה לבחירה מצוינת כרכב ספורט משומש.' },
        { name: 'פורד מוסטנג GT', price: 200000, features: ['מנוע V8 עוצמתי', 'עיצוב אמריקאי קלאסי', 'ביצועים גבוהים', 'מחיר אטרקטיבי', 'קהילת חובבים גדולה'], description: 'פורד מוסטנג GT היא אייקון אמריקאי אמיתי. עם מנוע V8 עוצמתי ועיצוב קלאסי, היא מציעה חוויית נהיגה אמריקאית אותנטית. המחיר האטרקטיבי וקהילת החובבים הגדולה הופכים אותה לבחירה פופולרית בשוק הרכבים המשומשים.' },
        { name: 'פורשה קיימן', price: 250000, features: ['איזון מושלם', 'חווית נהיגה מדויקת', 'איכות בנייה גבוהה', 'עיצוב אלגנטי', 'מנוע במרכז הרכב'], description: 'פורשה קיימן ידועה באיזון המושלם שלה ובחווית הנהיגה המדויקת. עם מנוע במרכז הרכב ואיכות בנייה גבוהה, היא מציעה ביצועים מרשימים לצד עיצוב אלגנטי. זוהי בחירה מצוינת למי שמחפש מכונית ספורט יומיומית.' },
        { name: 'BMW M3', price: 280000, features: ['ביצועים גבוהים', 'נוחות יומיומית', 'טכנולוגיה מתקדמת', 'מותג יוקרתי', 'ארבע דלתות'], description: 'BMW M3 היא הגרסה הספורטיבית של סדרה 3 הפופולרית. היא משלבת ביצועים גבוהים עם נוחות יומיומית, מה שהופך אותה לבחירה מצוינת למי שמחפש רכב ספורט פרקטי. הטכנולוגיה המתקדמת והמותג היוקרתי מוסיפים לאטרקטיביות שלה.' },
        { name: 'אודי TT', price: 180000, features: ['עיצוב ייחודי', 'ביצועים טובים', 'איכות גרמנית', 'טכנולוגיה מתקדמת', 'חסכוני יחסית'], description: 'אודי TT היא מכונית ספורט קומפקטית עם עיצוב ייחודי ומרשים. היא מציעה ביצועים טובים לצד איכות גרמנית ידועה. הטכנולוגיה המתקדמת והחסכוניות היחסית הופכות אותה לבחירה מעניינת בקטגוריית הספורט המשומשות.' }
      ]
    }
  };

  // פונקציות עזר
  const getPersonalityTraits = (occupation) => {
    return personalityTraits[occupation] || ['גמיש', 'מסתגל', 'יעיל', 'מקצועי', 'אחראי'];
  };

  const getRecommendedCars = (carType, isNew, personalityTraits, budget = null, fuelType = null, carDatabase) => {
    console.log(`getRecommendedCars נקרא עם הפרמטרים:`, { carType, isNew, personalityTraits, budget, fuelType });
    
    const condition = isNew ? 'חדש' : 'משומש';
    if (!carDatabase[carType] || !carDatabase[carType][condition]) {
      console.warn(`לא נמצאו רכבים מסוג "${carType}" במצב "${condition}". מחזיר רשימה ריקה.`);
      return { cars: [], minPrice: 0, maxPrice: 0 };
    }
    
    let cars = carDatabase[carType][condition];
    console.log(`נמצאו ${cars.length} רכבים לפני סינון:`, cars);
    
    // מיון רכבים לפי התאמה לתכונות אישיות
    cars.sort((a, b) => {
      const aScore = a.features.filter(feature => personalityTraits.includes(feature)).length;
      const bScore = b.features.filter(feature => personalityTraits.includes(feature)).length;
      return bScore - aScore;
    });
    console.log('רכבים אחרי מיון לפי תכונות אישיות:', cars);

    // סינון לפי סוג דלק אם הוגדר
    if (fuelType && fuelType !== '') {
      cars = cars.filter(car => car.fuelType === fuelType || !car.fuelType);
      console.log(`רכבים אחרי סינון לפי סוג דלק (${fuelType}):`, cars);
    }

    // סינון לפי תקציב אם הוגדר
    let filteredCars = cars;
    if (budget && budget > 0) {
      filteredCars = cars.filter(car => car.price <= budget);
      console.log(`רכבים אחרי סינון לפי תקציב (עד ${budget}):`, filteredCars);
    }

    const minPrice = filteredCars.length > 0 ? Math.min(...filteredCars.map(car => car.price)) : 0;
    const maxPrice = filteredCars.length > 0 ? Math.max(...filteredCars.map(car => car.price)) : 0;

    console.log(`מחזיר ${filteredCars.length} רכבים מומלצים`);
    return { 
      cars: filteredCars, 
      minPrice: minPrice, 
      maxPrice: maxPrice 
    };
  };

  const calculateNumerology = (name) => {
    const hebrewAlphabet = {
      'א': 1, 'ב': 2, 'ג': 3, 'ד': 4, 'ה': 5, 'ו': 6, 'ז': 7, 'ח': 8, 'ט': 9,
      'י': 10, 'כ': 20, 'ל': 30, 'מ': 40, 'נ': 50, 'ס': 60, 'ע': 70, 'פ': 80, 'צ': 90,
      'ק': 100, 'ר': 200, 'ש': 300, 'ת': 400
    };

    let sum = 0;
    for (let char of name) {
      if (hebrewAlphabet[char]) {
        sum += hebrewAlphabet[char];
      }
    }

    while (sum > 9) {
      sum = sum.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
    }

    return sum;
  };

  const getZodiacSign = (birthdate) => {
    const [day, month] = birthdate.split('/').map(Number);
    
    if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) return 'טלה';
    if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) return 'שור';
    if ((month === 5 && day >= 21) || (month === 6 && day <= 20)) return 'תאומים';
    if ((month === 6 && day >= 21) || (month === 7 && day <= 22)) return 'סרטן';
    if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) return 'אריה';
    if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) return 'בתולה';
    if ((month === 9 && day >= 23) || (month === 10 && day <= 22)) return 'מאזניים';
    if ((month === 10 && day >= 23) || (month === 11 && day <= 21)) return 'עקרב';
    if ((month === 11 && day >= 22) || (month === 12 && day <= 21)) return 'קשת';
    if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) return 'גדי';
    if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) return 'דלי';
    return 'דגים';
  };

  const generatePersonalizedOpening = (firstName, lastName, age, occupation, birthdate) => {
    const numerologyNumber = calculateNumerology(firstName + lastName);
    const zodiacSign = getZodiacSign(birthdate);
    
    const openings = [
      `שלום ${firstName}, נעים להכיר! בוא נמצא יחד את הרכב המושלם שיתאים לאורח החיים הדינמי שלך.`,
      `היי ${firstName}! תודה שפנית אלינו. אני בטוח שיש לך דרישות מיוחדות מהרכב שלך. בוא נגלה יחד איזה רכב יענה על כל הצרכים שלך.`,
      `ברוך הבא, ${firstName}! מרתק לשמוע על הרקע שלך. אני מניח שאתה מחפש רכב שישלב בין נוחות, ביצועים ופרקטיות. נכון?`,
      `${firstName}, איזה כיף שהגעת אלינו! אני בטוח שיש לך ניסיון חיים מעניין. אשמח לשמוע יותר על הציפיות שלך מהרכב החדש.`,
      `היי ${firstName}, תודה שבחרת בנו! אני מתרגש לעזור לך למצוא את הרכב המושלם. אני מניח שאתה מחפש משהו שבאמת יתאים לסגנון החיים הדינמי שלך.`
    ];

    return openings[Math.floor(Math.random() * openings.length)];
  };

  const generatePersonalizedCarDescription = (car, personalityTraits) => {
    const descriptions = [
      `ה${car.name} ידוע ב${car.features[0]} וב${car.features[1]} שלו. זה יכול להתאים מצוין לאורח החיים הדינמי שלך.`,
      `עבור מי שמחפש ${car.features[2]} ו${car.features[3]}, ה${car.name} יכול להיות בחירה מעולה. זה במיוחד נכון למי שמעריך איכות וביצועים.`,
      `ה${car.name} משלב ${car.features[0]} עם ${car.features[4]}. זו יכולה להיות התאמה נהדרת למי שמחפש חוויית נהיגה יוצאת דופן.`,
      `אם אתה מחפש רכב שמציע ${car.features[1]} ו${car.features[3]}, ה${car.name} יכול להיות בדיוק מה שאתה צריך. זה במיוחד מתאים למי שמעריך חדשנות וטכנולוגיה מתקדמת.`,
      `ה${car.name} ידוע בזכות ה${car.features[2]} וה${car.features[4]} שלו. אלו תכונות שיכולות להתאים מאוד לסגנון החיים התובעני שלך.`
    ];

    return descriptions[Math.floor(Math.random() * descriptions.length)];
  };

  const generateFinancingBenefits = (firstName, personalityTraits, carPrice) => {
    const maxPayments = 100;
    const interestRate = 3.5; // ריבית שנתית ב-%
    const monthlyInterestRate = interestRate / 12 / 100;
    
    const monthlyPayment = (carPrice * monthlyInterestRate * Math.pow(1 + monthlyInterestRate, maxPayments)) / (Math.pow(1 + monthlyInterestRate, maxPayments) - 1);

    let benefits = `
    ${firstName}, הנה כמה אפשרויות מימון שיכולות להתאים לך:

    1. פריסת תשלומים גמישה: אנחנו מציעים פריסה של עד ${maxPayments} תשלומים, עם תשלום חודשי של כ-${Math.round(monthlyPayment)} ש"ח. `;
    
    benefits += `זה מאפשר לך ליהנות מהרכב תוך שמירה על תזרים מזומנים נוח, בהתאם לצרכים הספציפיים שלך.`;

    benefits += `

    2. תקופת חסד בתחילת ההלוואה: אתה יכול לדחות את התשלום הראשון בעד 3 חודשים. `;
    
    benefits += `זה נותן לך זמן להתרגל לרכב החדש ולהתארגן מבחינה כלכלית, בלי לחץ מיידי של תשלומים.`;

    benefits += `

    3. אפשרות לפירעון מוקדם: אתה יכול לפרוע את ההלוואה בכל שלב ללא קנס. `;
    
    benefits += `זה מעניק לך שקט נפשי, כי אתה יודע שיש לך אפשרות לסיים את ההלוואה מתי שתרצה, בהתאם למצבך הכלכלי.`;

    benefits += `

    4. ליווי אישי: הצוות שלנו ילווה אותך לאורך כל התהליך, מהבחירה ועד לאחר הרכישה. `;
    
    benefits += `זה מבטיח שתקבל את התמיכה והמידע הנחוצים בכל שלב בדרך, מההתלבטות הראשונית ועד לטיפולים השוטפים ברכב.`;

    benefits += `

    5. תוכנית Trade-in: אם יש לך רכב ישן, אנחנו יכולים להציע לך עסקת החלפה אטרקטיבית. `;
    
    benefits += `זו אפשרות נהדרת להקל על המעבר לרכב החדש שלך, תוך הפחתת העלויות הכוללות של העסקה.`;

    benefits += `

    איך כל זה נשמע לך? האם יש אפשרות מימון ספציפית שמעניינת אותך במיוחד או שאתה רוצה לשמוע עוד פרטים לגביה?`;

    return benefits ;
  };

  const generatePersonalizedClosing = (firstName) => {
    const closings = [
      `לאור מה שדיברנו, אני חושב שיש לנו כאן כמה אפשרויות מעולות עבורך. מה דעתך שניפגש ונדבר על זה יותר לעומק? אני בטוח שנוכל למצוא את הרכב המושלם שיתאים לאישיות הייחודית שלך.`,
      `תודה שהקדשת מזמנך. אני מרגיש שיש לנו כאן התאמה טובה. אשמח אם נוכל לקבוע פגישה ולהמשיך את השיחה פנים מול פנים. יש לנו עוד הרבה אפשרויות מרתקות לדון בהן.`,
      `נראה שיש לנו כמה אפשרויות מעניינות לבחון. אני בטוח שתעריך את מה שיש לנו להציע. אולי כדאי שנקבע זמן לפגישה בסוכנות? ככה תוכל לראות ולהרגיש את הרכבים בעצמך.`,
      `אני מאמין שמצאנו כמה אפשרויות שיכולות להתאים לך בול. אני חושב שתהנה לראות את הרכבים מקרוב. מה דעתך לקפוץ אלינו לסוכנות ולהמשיך את השיחה שם?`,
      `אחרי השיחה הזו, אני מרגיש שאנחנו בכיוון הנכון. אני בטוח שתעריך את תהליך הבחירה המעמיק שלנו. בוא נקבע פגישה בסוכנות, שם נוכל לדבר יותר לעומק ולבחון את האפשרויות מקרוב.`
    ];

    return closings[Math.floor(Math.random() * closings.length)];
  };

  const generateScript = (firstName, lastName, age, occupation, carType, isNew, birthdate, budget = null, fuelType = null, carDatabase) => {
    console.log(`generateScript נקרא עם הפרמטרים:`, { firstName, lastName, age, occupation, carType, isNew, birthdate, budget, fuelType });
    
    const personalityTraits = getPersonalityTraits(occupation);
    const { cars: recommendedCars, minPrice, maxPrice } = getRecommendedCars(carType, isNew, personalityTraits, budget, fuelType, carDatabase);
    const carCondition = isNew ? 'חדש' : 'משומש באיכות גבוהה';

    const opening = generatePersonalizedOpening(firstName, lastName, age, occupation, birthdate);
    
    if (recommendedCars.length === 0) {
      console.log('לא נמצאו רכבים מומלצים');
      return `
      ${opening}

      לצערי, לא מצאתי רכבים מתאימים בדיוק לפי הקריטריונים שציינת. 
      האם תרצה לשקול טווח מחירים רחב יותר? אני יכול להציע לך רכבים בטווח שבין ${minPrice.toLocaleString()} ₪ ל-${maxPrice.toLocaleString()} ₪.

      אני כאן לעזור לך למצוא את הרכב המושלם עבורך. בוא ננסה יחד לחשוב על אפשרויות נוספות.
      `;
    }

    console.log(`נמצאו ${recommendedCars.length} רכבים מומלצים`);

    const mainCar = recommendedCars[0];
    const otherCars = recommendedCars.slice(1, 3);

    const numerologyNumber = calculateNumerology(firstName + lastName);
    const zodiacSign = getZodiacSign(birthdate);

    let script = `
    ${opening}

    בהתחשב במה שסיפרת לי והצרכים שלך, אני חושב שה${mainCar.name} ${carCondition} יכול להיות התאמה מעולה עבורך. 
    המחיר שלו הוא ${mainCar.price.toLocaleString()} ₪, והרכבים שאציג לך נעים בטווח שבין ${minPrice.toLocaleString()} ₪ ל-${maxPrice.toLocaleString()} ₪.

    ${generatePersonalizedCarDescription(mainCar, personalityTraits)}

    ${mainCar.description}

    מעניין לציין, ${firstName}, שהמספר הנומרולוגי שלך הוא ${numerologyNumber}, שמסמל ${getNumerologyDescription(numerologyNumber)}. זה מתאים מאוד לתכונות של ה${mainCar.name}, במיוחד ב${mainCar.features[numerologyNumber % 5]}.

    בנוסף, כמי שנולד במזל ${zodiacSign}, אתה כנראה מעריך ${getZodiacTraits(zodiacSign)}. ה${mainCar.name} מתאים לתכונות אלו בזכות ה${mainCar.features[2]} וה${mainCar.features[4]} שלו.

    ${generateFinancingBenefits(firstName, personalityTraits, mainCar.price)}

    ${generatePersonalizedClosing(firstName)}

    אם זה נשמע לך טוב, אני יכול לתאם לך פגישה עם אחד המומחים שלנו עוד היום. יש לנו זמן פנוי ב-14:00 או ב-16:30. מה יותר נוח לך?

    אני כאן לכל שאלה או התלבטות. המטרה שלי היא לעזור לך למצוא את הרכב המושלם, בתנאים שמתאימים בדיוק לך.
    `;

    return script;
  };

  const getNumerologyDescription = (number) => {
    const descriptions = {
      1: 'מנהיגות ועצמאות',
      2: 'שיתוף פעולה והרמוניה',
      3: 'יצירתיות וביטוי עצמי',
      4: 'יציבות ומעשיות',
      5: 'חופש והרפתקנות',
      6: 'אחריות ואיזון',
      7: 'חוכמה ואינטואיציה',
      8: 'כוח והישגיות',
      9: 'אידיאליזם ואנושיות'
    };
    return descriptions[number] || 'תכונות מיוחדות ומגוונות';
  };

  const getZodiacTraits = (sign) => {
    const traits = {
      'טלה': 'אנרגטיות ויוזמה',
      'שור': 'יציבות ונאמנות',
      'תאומים': 'תקשורתיות וסקרנות',
      'סרטן': 'רגישות ואינטואיציה',
      'אריה': 'יצירתיות וביטחון עצמי',
      'בתולה': 'דייקנות ומעשיות',
      'מאזניים': 'הרמוניה ודיפלומטיות',
      'עקרב': 'נחישות ותשוקה',
      'קשת': 'אופטימיות והרפתקנות',
      'גדי': 'אחריות ושאפתנות',
      'דלי': 'מקוריות וחדשנות',
      'דגים': 'אמפתיה ודמיון'
    };
    return traits[sign] || 'תכונות ייחודיות ומעניינות';
  };

  const [firstName, setFirstName] = useState('');
  const [lastName, setLastName] = useState('');
  const [birthdate, setBirthdate] = useState(null);
  const [birthdateInput, setBirthdateInput] = useState('');
  const [age, setAge] = useState('');
  const [occupation, setOccupation] = useState('');
  const [carType, setCarType] = useState('');
  const [isNew, setIsNew] = useState(true);
  const [analysis, setAnalysis] = useState(null);
  const [expandedCar, setExpandedCar] = useState(null);
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [showOccupationSuggestions, setShowOccupationSuggestions] = useState(false);
  const [filteredOccupations, setFilteredOccupations] = useState([]);
  const [budget, setBudget] = useState('');
  const [fuelType, setFuelType] = useState('');
  const [priceRange, setPriceRange] = useState([0, 1000000]);

  const occupationInputRef = useRef(null);

  useEffect(() => {
    if (birthdate) {
      const today = new Date();
      let calculatedAge = today.getFullYear() - birthdate.getFullYear();
      const m = today.getMonth() - birthdate.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birthdate.getDate())) {
        calculatedAge--;
      }
      setAge(calculatedAge.toString());
    }
  }, [birthdate]);

  const handleBirthdateChange = (e) => {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 8) value = value.slice(0, 8);
    
    if (value.length > 4) {
      value = `${value.slice(0, 2)}/${value.slice(2, 4)}/${value.slice(4)}`;
    } else if (value.length > 2) {
      value = `${value.slice(0, 2)}/${value.slice(2)}`;
    }
    
    setBirthdateInput(value);
    
    if (value.length === 10) {
      const [day, month, year] = value.split('/');
      const date = new Date(year, month - 1, day);
      if (date instanceof Date && !isNaN(date)) {
        setBirthdate(date);
      }
    } else {
      setBirthdate(null);
    }
  };

  const handleOccupationChange = (e) => {
    const value = e.target.value;
    setOccupation(value);
    
    if (value.length > 0) {
      const matchingOccupations = occupations.filter(occ => 
        occ.toLowerCase().includes(value.toLowerCase())
      );
      setFilteredOccupations(matchingOccupations);
      setShowOccupationSuggestions(true);
    } else {
      setShowOccupationSuggestions(false);
    }
  };

  const selectOccupation = (selectedOccupation) => {
    setOccupation(selectedOccupation);
    setShowOccupationSuggestions(false);
  };

  const handleOccupationKeyDown = (e, selectedOccupation) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      selectOccupation(selectedOccupation);
    }
  };

  const validateForm = () => {
    let errors = {};
    if (!firstName.trim()) errors.firstName = 'שם פרטי הוא שדה חובה';
    if (!lastName.trim()) errors.lastName = 'שם משפחה הוא שדה חובה';
    if (!occupation.trim()) errors.occupation = 'מקצוע הוא שדה חובה';
    if (!carType) errors.carType = 'סוג רכב הוא שדה חובה';
    if (!birthdate) errors.birthdate = 'תאריך לידה הוא שדה חובה';
    if (!fuelType) errors.fuelType = 'סוג דלק הוא שדה חובה';

    if (birthdate) {
      const calculatedAge = parseInt(age);
      if (calculatedAge < 18 || calculatedAge > 80) {
        errors.birthdate = 'גיל חייב להיות בין 18 ל-80';
      }
    }

    setErrors(errors);
    return Object.keys(errors).length === 0;
  };

  const analyzeAndCreateScript = async () => {
    if (!validateForm()) return;

    setIsLoading(true);
    
    // סימולציה של פעולה אסינכרונית
    await new Promise(resolve => setTimeout(resolve, 1500));

    console.log('קריאה ל-generateScript עם הפרמטרים:', {
      firstName,
      lastName,
      age: parseInt(age) || 30,
      occupation,
      carType,
      isNew,
      birthdate: birthdate.toLocaleDateString('he-IL'),
      budget: priceRange[1],
      fuelType
    });

    const script = generateScript(
      firstName,
      lastName,
      parseInt(age) || 30,
      occupation,
      carType,
      isNew,
      birthdate.toLocaleDateString('he-IL'),
      priceRange[1],
      fuelType,
      carDatabase
    );
    
    const personalityTraits = getPersonalityTraits(occupation);
    const { cars: recommendedCars, minPrice, maxPrice } = getRecommendedCars(carType, isNew, personalityTraits, priceRange[1], fuelType, carDatabase);
    
    setAnalysis({ 
      conversationScript: script,
      mainCar: recommendedCars.length > 0 ? recommendedCars[0] : null,
      otherCars: recommendedCars.slice(1, 3),
      priceRange: { min: minPrice, max: maxPrice }
    });

    setIsLoading(false);
  };

  const resetForm = () => {
    setFirstName('');
    setLastName('');
    setBirthdate(null);
    setBirthdateInput('');
    setAge('');
    setOccupation('');
    setCarType('');
    setIsNew(true);
    setAnalysis(null);
    setExpandedCar(null);
    setErrors({});
    setBudget('');
    setFuelType('');
    setPriceRange([0, 1000000]);
  };

  const toggleCarDetails = (carName) => {
    setExpandedCar(expandedCar === carName ? null : carName);
  };

  const handleKeyPress = (e) => {
    if (e.key === 'Enter') {
      analyzeAndCreateScript();
    }
  };

  return (
    <div className="analyzer-container">
      <h1>מנתח שיחת מימון ומכירת רכב מתקדם</h1>
      <div className="input-group">
        <input 
          type="text" 
          placeholder="שם פרטי" 
          value={firstName} 
          onChange={(e) => setFirstName(e.target.value)}
          onKeyPress={handleKeyPress}
          className={errors.firstName ? 'error' : ''}
        />
        {errors.firstName && <span className="error-message">{errors.firstName}</span>}

        <input 
          type="text" 
          placeholder="שם משפחה" 
          value={lastName} 
          onChange={(e) => setLastName(e.target.value)}
          onKeyPress={handleKeyPress}
          className={errors.lastName ? 'error' : ''}
        />
        {errors.lastName && <span className="error-message">{errors.lastName}</span>}

        <input
          type="text"
          placeholder="תאריך לידה (DD/MM/YYYY)"
          value={birthdateInput}
          onChange={handleBirthdateChange}
          onKeyPress={handleKeyPress}
          className={errors.birthdate ? 'error' : ''}
        />
        {errors.birthdate && <span className="error-message">{errors.birthdate}</span>}

        <div className="occupation-input-container">
          <input 
            type="text" 
            placeholder="מקצוע" 
            value={occupation} 
            onChange={handleOccupationChange}
            onFocus={() => setShowOccupationSuggestions(true)}
            className={errors.occupation ? 'error' : ''}
          />
          {errors.occupation && <span className="error-message">{errors.occupation}</span>}
          {showOccupationSuggestions && (
            <div className="occupation-suggestions">
              {filteredOccupations.map((occ, index) => (
                <div 
                  key={occ} 
                  className="occupation-suggestion"
                  onClick={() => selectOccupation(occ)}
                  tabIndex={0}
                  onKeyDown={(e) => handleOccupationKeyDown(e, occ)}
                >
                  {occ}
                </div>
              ))}
            </div>
          )}
        </div>

        <select 
          value={carType} 
          onChange={(e) => setCarType(e.target.value)}
          onKeyPress={handleKeyPress}
          className={errors.carType ? 'error' : ''}
        >
          <option value="">בחר סוג רכב</option>
          {carTypes.map(type => <option key={type} value={type}>{type}</option>)}
        </select>
        {errors.carType && <span className="error-message">{errors.carType}</span>}

        <select 
          value={fuelType} 
          onChange={(e) => setFuelType(e.target.value)}
          onKeyPress={handleKeyPress}
          className={errors.fuelType ? 'error' : ''}
        >
          <option value="">בחר סוג דלק</option>
          {fuelTypes.map(type => <option key={type} value={type}>{type}</option>)}
        </select>
        {errors.fuelType && <span className="error-message">{errors.fuelType}</span>}

        <div className="price-range-slider">
          <label>טווח מחירים:</label>
          <input
            type="range"
            min="0"
            max="1000000"
            step="10000"
            value={priceRange[1]}
            onChange={(e) => setPriceRange([0, parseInt(e.target.value)])}
          />
          <span>{priceRange[1].toLocaleString()} ₪</span>
        </div>

        <div className="radio-group">
          <label>
            <input 
              type="radio" 
              value="new" 
              checked={isNew} 
              onChange={() => setIsNew(true)} 
            />
            רכב חדש
          </label>
          <label>
            <input 
              type="radio" 
              value="used" 
              checked={!isNew} 
              onChange={() => setIsNew(false)} 
            />
            רכב משומש
          </label>
        </div>
      </div>
      <button onClick={analyzeAndCreateScript} disabled={isLoading}>
        {isLoading ? 'מעבד...' : 'צור תסריט שיחה מתקדם'}
      </button>
      {analysis && (
        <div className="analysis-result">
          <h3>תסריט שיחה מפורט:</h3>
          <pre>{analysis.conversationScript}</pre>
          <h3>רכבים מומלצים:</h3>
          <div className="car-recommendations">
            {analysis.mainCar && (
              <div className="main-car">
                <h4>הרכב המומלץ ביותר:</h4>
                <p>{analysis.mainCar.name}</p>
                <ul>
                  {analysis.mainCar.features.map((feature, idx) => (
                    <li key={idx}>{feature}</li>
                  ))}
                </ul>
                <p>{analysis.mainCar.description}</p>
              </div>
            )}
            <div className="other-cars">
              <h4>אפשרויות נוספות:</h4>
              {analysis.otherCars.map((car, index) => (
                <div key={car.name} className="car-option">
                  <p onClick={() => toggleCarDetails(car.name)} style={{cursor: 'pointer'}}>
                    {car.name} {expandedCar === car.name ? '▼' : '►'}
                  </p>
                  {expandedCar === car.name && (
                    <div>
                      <ul>
                        {car.features.map((feature, idx) => (
                          <li key={idx}>{feature}</li>
                        ))}
                      </ul>
                      <p>{car.description}</p>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
          <button onClick={resetForm}>אפס טופס</button>
        </div>
      )}
    </div>
  );
};

export default CarFinancingConversationAnalyzer;